<div id="tabs" style="width: 990px;margin: 0px auto;">
  <ul>
    <li><a href="#tabs-1">我的訂位記錄</a></li>
    <li><a href="#tabs-2">我的會員資料</a></li>
  </ul>
  <div id="tabs-1">
    <%= render :partial => 'booking_record' %>
  </div>
  <div id="tabs-2">
    <%= render :template => 'devise/registrations/edit',
               :locals => {
                       :resource => @booker,
                       :resource_name => 'user' } %>
  </div>
</div>


<div id="myModal" class="modal hide fade in" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" name="close_modal">×</button>
    <h4 id="myModalLabel">輸入消費感想</h4>
  </div>
  <div class="modal-body">
    <textarea id="feedback"></textarea>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true" name='close_modal'>關閉</button>
    <button class="btn btn-primary" name="save_feedback">儲存</button>
  </div>
</div>


<script>
    $('[name=showModal]').click(function(){
        $('#myModal').show().offset($(this).offset());
    });

    $('[name=close_modal]').click(function(){
        $('#myModal').hide();
    });

    $('[name=save_feedback]').click(function(){
        var feedback = $('#feedback').val()
        var booking_id = $('#feedback_btn').data('value')

        $.ajax({
            url: "/booker_manage/feedback",
            type: 'POST',
            data:  {booking_id: booking_id,feedback: feedback},
            cache: false,
            async: false,
            success: function(response){
                if (response.success)
                    alert(response.data)
                else if (response.error)
                    alert(response.message)
                else
                    alert('發生未預期的回應，請告知CoDream小組處理!')
                $('#myModal').hide();
            },
            error: function(){
                alert('oops! 出現錯誤了!');
                $('#myModal').hide();
            }
        });
    });
</script>